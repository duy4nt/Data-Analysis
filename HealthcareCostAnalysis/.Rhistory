ggplot(aes(x = weekD, y = sales)) + geom_col(position = "dodge") +
labs(x= "Weekday", y = "Quantity", title = "Quantity sold throughout the Week") +
theme_classic()
onlineRetailV2 %>% group_by(weekD) %>% summarise(sales = sum(totalAmount)) %>%
ggplot(aes(x = weekD, y = sales)) + geom_line() +
labs(x= "Weekday", y = "Sales", title = "Sales throughout the Week") +
theme_classic()
onlineRetailV2 %>% group_by(weekD) %>% summarise(sales = sum(Quantity)) %>%
ggplot(aes(x = weekD, y = sales)) + geom_line(position = "dodge") +
labs(x= "Weekday", y = "Quantity", title = "Quantity sold throughout the Week") +
theme_classic()
onlineRetailV2 %>% group_by(weekD) %>% summarise(sales = sum(Quantity)) %>%
ggplot(aes(x = weekD, y = sales)) + geom_line() +
labs(x= "Weekday", y = "Quantity", title = "Quantity sold throughout the Week") +
theme_classic()
onlineRetailV2 %>%  group_by(month) %>%  summarise(sales = sum(totalAmount)) %>%
ggplot(aes(x= as.factor(month), y= sales)) + geom_line() +
labs(x= "Months", y= "Sales", title = "Sales throughtout the year") +
theme_classic()
onlineRetailV2 %>%  group_by(month) %>%  summarise(sales = sum(totalAmount)) %>%
ggplot() + geom_line(aes(x= as.factor(month), y= sales)) +
labs(x= "Months", y= "Sales", title = "Sales throughtout the year") +
theme_classic()
onlineRetailV2 %>%  group_by(CustomerID, InvoiceDate) %>%  summarise(cnt = n()) %>%
count() %>%  arrange(desc(n)) %>%  ungroup() %>%  top_n(5) %>%
ggplot(aes(x= as.factor(CustomerID), y= n)) + geom_col(position = "dodge") +
labs(x= "Customer Id", y="No of times visited",
title = "Top 5 Customer according to their their frequency of Purchase") +
theme_classic()
onlineRetailV2 %>%  group_by(StockCode) %>%  summarise(total = count(Quantity)) %>%
arrange(desc(total)) %>%  top_n(5) %>%
ggplot(aes(x = as.factor(StockCode), y = total)) + geom_col(position = "dodge") +
labs(x = "Stock Code", y = "Quantities Sold", title = "Top 5 Revenue Generating Items") +
theme_classic()
onlineRetailV2 %>%  group_by(StockCode) %>%  summarise(total = sum(Quantity)) %>%
arrange(desc(total)) %>%  top_n(5) %>%
ggplot(aes(x = as.factor(StockCode), y = total)) + geom_col(position = "dodge") +
labs(x = "Stock Code", y = "Quantities Sold", title = "Top 5 Revenue Generating Items") +
theme_classic()
onlineRetailV2 %>%  group_by(StockCode) %>%  summarise(total = sum(Quantity)) %>%
arrange(desc(total)) %>%  top_n(5) %>%
ggplot(aes(x = as.factor(StockCode), y = total)) + geom_col(position = "dodge") +
labs(x = "Stock Code", y = "Quantities Sold", title = "Top 5 Quantity selling Items") +
theme_classic()
onlineRetailV2 %>% group_by(weekD) %>% summarise(sales = sum(totalAmount))
onlineRetailV2 %>%  select(c(month, weekD, totalAmount)) %>%  group_by(month, weekD) %>%
summarise(sales = sum(totalAmount)) %>% arrange(desc(sales)) %>%  slice(1:3) %>%
print(n = 36)
onlineRetailV2 %>%  group_by(StockCode) %>%  summarise(revenue = sum(totalAmount)) %>%
arrange(desc(revenue)) %>%  slice(1:5)
onlineRetailV2 %>%  group_by(CustomerID, InvoiceDate) %>%
summarise(spend = sum(totalAmount)) %>%  arrange(InvoiceDate)
onlineRetailV2 %>% group_by(Country, CustomerID) %>% summarise(revenue = sum(totalAmount)) %>%
arrange(desc(revenue)) %>% slice(1:5)
onlineRetailV2 %>%  group_by(CustomerID) %>%  summarise(no = n()) %>%
filter(no > 1) %>%  arrange(desc(no)) %>%  slice(1:5)
onlineRetailV2 %>%  group_by(CustomerID, InvoiceDate) %>%  summarise(cnt = n()) %>%
count() %>%  arrange(desc(n))
onlineRetailV2 %>%  group_by(month, date) %>% summarise(revenue = sum(totalAmount)) %>%
arrange(desc(revenue)) %>% slice(1:5) %>%  print(n= 60)
onlineRetailV2 %>%  group_by(month) %>%  summarise(sales = sum(totalAmount))
onlineRetailV2 %>%  group_by(month) %>%  summarise(sales = sum(Quantity))
onlineRetailV2[order(onlineRetailV2$Quantity, decreasing = TRUE),]
onlineRetailV2 %>% arrange(desc(Quantity))  %>% group_by(Country, CustomerID) %>%
summarise(total = sum(Quantity), quantity = n()) %>%  slice(1:5)
onlineRetailV2 %>%  group_by(Country) %>%
summarise(soldUnits = sum(Quantity)) %>%  arrange(soldUnits, FALSE)
onlineRetailV2 %>%  group_by(Country) %>%
summarise(soldUnits = sum(Quantity)) %>%  arrange(desc(soldUnits)) %>%
filter(Country != "United Kingdom")
onlineRetailV2 %>%  group_by(Country) %>%  arrange(desc(Quantity)) %>%
top_n(5) %>%  slice(1:5)
onlineRetailV2 %>%  group_by(Country) %>%
summarise(revenueGenerated = sum(Quantity * UnitPrice)) %>%
arrange(desc(revenueGenerated)) %>% filter(Country != "United Kingdom")
onlineRetailV2 %>%  group_by(Country) %>%
summarise(revenueGenerated = sum(Quantity * UnitPrice)) %>%
arrange((revenueGenerated)) %>% filter(Country != "United Kingdom")
onlineRetailV2 %>%  group_by(CustomerID, InvoiceDate) %>%
summarise(spend = sum(totalAmount)) %>%  arrange(InvoiceDate) print(n=132)
onlineRetailV2 %>%  group_by(CustomerID, InvoiceDate) %>%
summarise(spend = sum(totalAmount)) %>%  arrange(InvoiceDate) %>%  print(n=132)
onlineRetailV2 %>% group_by(Country, CustomerID) %>% summarise(revenue = sum(totalAmount)) %>%
arrange(desc(revenue)) %>% slice(1:5) %>%  print(n=132)
library(usethis)
install.packages("usethis")
library(usethis)
edit_git_config()
use_git()
onlineRetailV2 %>% group_by(weekD) %>% summarise(sales = sum(totalAmount)) %>%
ggplot(aes(x = weekD, y = sales)) + geom_line() +
labs(x= "Weekday", y = "Sales", title = "Sales throughout the Week") +
theme_classic()
library(tidyverse)
library(dplyr)
library(ggplot2)
library(lubridate)
onlineRetailV2 %>%  group_by(month) %>%  summarise(sales = sum(totalAmount)) %>%
ggplot(aes(x= (month), y= sales)) + geom_line() +
labs(x= "Months", y= "Sales", title = "Sales throughtout the year") +
theme_classic()
head(diamonds)
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
head(diamonds)
library(diamonds)
str(diamonds)
colnames(diamonds)
summary(diamonds)
view(diamonds)
diamonds %>%  group_by(cut) %>%  summarise(price)
diamonds %>%  group_by(cut)
diamonds %>%  group_by(cut) %>%  summarise(pr = mean(price))
diamonds %>%  group_by(cut) %>%  summarise(priceOfDiamond = mean(price)) %>%  arrange(priceOfDiamond)
diamonds %>%  group_by(cut) %>%  summarise(priceOfDiamond = mean(price)) %>%  arrange(desc(priceOfDiamond))
diamonds %>%  group_by(clarity) %>%  summarise(priceOfDiamond = mean(price)) %>%  arrange(desc(priceOfDiamond))
?diamonds
diamonds %>%  group_by(deoth) %>%  summarise(priceOfDiamond = mean(price)) %>%  arrange(desc(priceOfDiamond))
diamonds %>%  group_by(depth) %>%  summarise(priceOfDiamond = mean(price)) %>%  arrange(desc(priceOfDiamond))
diamonds %>%  group_by(table) %>%  summarise(priceOfDiamond = mean(price)) %>%  arrange(desc(priceOfDiamond))
diamonds %>%  group_by(carat) %>%  summarise(priceOfDiamonds= mean(price))
diamonds %>%  group_by(color) %>%  summarise(priceOfDiamond = mean(price))
diamonds %>%  group_by(color) %>%  summarise(priceOfDiamond = mean(price)) %>%  arrange(desc(priceOfDiamond))
diamonds %>%  group_by(cut) %>%  count()
diamonds %>%  group_by(cut) %>%  count() %>% arrange(count())
diamonds %>%  group_by(cut) %>%  count() %>% arrange(n)
diamonds %>%  group_by(cut) %>%  count() %>% arrange(desc(n))
diamonds %>%  group_by(cut) %>% count() %>%  percent_rank(n)
?summarise
diaminds %>% count()
diamonds %>% count()
diamonds %>%  group_by(cut) %>% count() %>%  summarise(pp = n*100/53940)
diamonds %>%  group_by(cut) %>% count() %>%  summarise(pp = n*100/53940) %>%  arrange(desc(pp))
?ceil
>cein
?ceil
diamonds %>%  group_by(cut) %>% count() %>%  summarise(pp = round(n*100/53940, digits = 2) ) %>%  arrange(desc(pp)) %>%
```
?round
diamonds %>%  group_by(cut) %>% count() %>%  summarise(pp = floor(n*100/53940, digits = 2) ) %>%  arrange(desc(pp)) %>%
```
diamonds %>%  group_by(cut) %>% count() %>%  summarise(pp = floor(n*100/53940)) %>%  arrange(desc(pp)) %>%
```
diamonds %>%  group_by(cut) %>% count() %>%  summarise(pp = n*100/53940 ) %>%  arrange(desc(pp))
diamonds %>%  group_by(cut) %>% summarise(mean(x))
diamonds %>%  group_by(cut) %>% summarise(mean(x), mean(y))
diamonds %>%  group_by(cut) %>% summarise(mean(x), mean(y), mean(z))
diamonds %>%  group_by(color) %>% summarise(mean(x), mean(y), mean(z))
diamonds %>%  group_by(color) %>% summarise(mean(x), mean(y), mean(z)) %>%arrange(desc(mean(price)))
diamonds %>%  group_by(color) %>% summarise(mean(x), mean(y), mean(z))
diamonds %>%  group_by(color) %>% summarise(mean(x), mean(y), mean(z)) %>% arrange(desc(color))
View(diamonds)
View(diamond)
load("C:/Users/prate/Downloads/archive (2)/.Rhistory")
load("C:/Users/prate/Downloads/archive (2)/.RData")
setwd("C:/Users/prate/Downloads/archive (2)/")
getwd()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(visdat)
hccd <- read.csv("insurance.csv")
colnames(hccd)
head(hccd)
str(hccd)
summary(hccd)
vis_miss(hccd)
hccd <- hccd %>% distinct()
hccd %>% group_by(smoker) %>% summarise(mean(charges))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(visdat)
hccd <- read.csv("insurance.csv")
colnames(hccd)
head(hccd)
str(hccd)
summary(hccd)
vis_miss(hccd)
hccd <- hccd %>% distinct()
hccd %>% group_by(smoker) %>% summarise(mean(charges))
hccd %>% group_by(region) %>% summarise(mean(charges))
hccd %>% group_by(sex) %>% summarise(mean(charges))
hccd %>% group_by(sex) %>% summarise(smoker)
hccd %>% group_by(sex) %>% summarise(count(smoker))
hccd %>% group_by(sex)
hccd %>% group_by(sex) %>% group_by(smoker)
help("dplyr")
hccd %>% group_by(sex) %>% summarise(smoker)
hccd %>% group_by(sex) %>% summarise(smoker) %>%  count()
hccd %>% group_by(sex, smoker)
hccd %>% group_by(sex, smoker) %>% summarise(smoker)
hccd %>% group_by(sex, smoker) %>% summarise(smoker) %>% count()
hccd %>% group_by(sex, smoker) %>% reframe(smoker) %>% count()
hccd %>% group_by(sex, smoker) %>% summarise(smoker) %>% count
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% count()
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% summarise(s = count()) %>% (n*100)/s
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% summarise(s = count()) %>% *100/s
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% summarise(s = count()) %>% 'n'*100/s
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% summarise(s = count())
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% summarise(count())
hccd %>% filter(sex == 'male') %>% group_by(smoker)
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% count()
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% s=count()
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% count()
hccd %>% group_by(gender) %>% count()
hccd %>% group_by(sex) %>% count()
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% count() %>% summarise(p = n*100/675)
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% count() %>% summarise(percent = n*100/675)
hccd %>% filter(sex == 'female') %>% group_by(smoker) %>% summarise(percent = n*100/662)
hccd %>% filter(sex == 'female') %>% group_by(smoker) %>% count() %>% summarise(percent = n*100/662)
hccd
hccd %>% group_by(children) %>% summarise(mean(charges))
hccd %>% group_by(children) %>% sum
hccd %>% group_by(children) %>% sum()
hccd %>% group_by(children) %>% summarise(sum())
hccd
hccd %>% group_by(children) %>% summarise(mean(charges))
hccd %>% group_by(children) %>% summarise(mean(charges))
hccd %>% group_by(children)
hccd %>% group_by(children) %>% count()
hccd %>% group_by(children) %>% count()
hccd %>% group_by(region)
hccd %>% group_by(region) %>% count()
hccd %>% group_by(region) %>% count()
hccd %>% group_by(region, smokers) %>% summarise(count())
hccd %>% group_by(region, smoker) %>% summarise(count())
hccd %>% group_by(region, smoker) %>% summarise(sum()
)
hccd %>% group_by(region, smoker) %>% summarise(sum())
hccd %>% group_by(region) %>% summarise(sum())
hccd %>% group_by(region)
hccd %>% group_by(region) %>% summarise(sum())
hccd %>% group_by(region)
hccd %>% ggplot(aes(x = "bmi", y = "charges")) + geom_point() + labs(title = "Scatter plot of BMI and Charges", x = "BMI", y = "Charge($)")
hccd %>% ggplot(aes(x = bmi, y = charges)) + geom_point() + labs(title = "Scatter plot of BMI and Charges", x = "BMI", y = "Charge($)")
hccd %>% ggplot(aes(x = bmi, y = charges, color = smoker)) + geom_point() + labs(title = "Scatter plot of BMI and Charges", x = "BMI", y = "Charge($)")
hccd %>% ggplot(aes(x = bmi, y = charges, color = children)) + geom_point() + labs(title = "Scatter plot of BMI and Charges", x = "BMI", y = "Charge($)")
hccd %>% ggplot(aes(x = bmi, y = charges, color = age)) + geom_point() + labs(title = "Scatter plot of BMI and Charges", x = "BMI", y = "Charge($)")
hccd %>% ggplot(aes(x = bmi, y = charges, color = age)) + geom_point() + labs(title = "Scatter plot of BMI and Charge with Age of the Person", x = "BMI", y = "Charge($)")
hccd %>% ggplot(x = region, y = count()) + geom_bar()
hccd %>% ggplot(x = region, y = summarise(mean(bmi)) + geom_bar()
labs(title = "Saxsux")
hccd %>% ggplot(x = children, y = charges)) + geom_point() + labs(title = "Scatter plot of Number of dependent children with Charge", x = "Number of Children", y = "Charge($)")
hccd %>% ggplot(aes(x = children, y = charges)) + geom_point() + labs(title = "Scatter plot of Number of dependent children with Charge", x = "Number of Children", y = "Charge($)")
hccd %>% ggplot(aes(x = children, y = charges)) + geom_bar() + labs(title = "Scatter plot of Number of dependent children with Charge", x = "Number of Children", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges)) + geom_bar() + labs(title = "Scatter plot of Age with Charge", x = "Age", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges)) + geom_point() + labs(title = "Scatter plot of Age with Charge", x = "Age", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges, color = smoker)) + geom_point() + labs(title = "Scatter plot of Age with Charge", x = "Age", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges, color = smoker)) + geom_point() + labs(title = "Scatter plot of Age with Charge", x = "Age", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges, color = smoker)) + geom_point() + labs(title = "Scatter plot of Age with Charge", x = "Age", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges, color = children)) + geom_point() + labs(title = "Scatter plot of Age with Charge", x = "Age", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges, color = region)) + geom_point() + labs(title = "Scatter plot of Age with Charge", x = "Age", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges, color = sex)) + geom_point() + labs(title = "Scatter plot of Age with Charge", x = "Age", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = bmi)) + geom_line()
hccd %>% ggplot(aes(x = age, y = summarise(mean(bmi)))) + geom_line()
View(hccd)
View(hccd)
hccd %>% ggplot(aes(x = region, y = charges)) + geom_bar()
hccd %>% group_by(region) %>% summarize(s = sum(charges))%>% ggplot(aes(x = region, y = charges)) + geom_bar()
hccd %>% group_by(region) %>% summarize(s = sum(charges))%>% ggplot(aes(x = s, y = charges)) + geom_bar()
hccd %>% group_by(region) %>% summarize(s = mean(charges))%>% ggplot(aes(x = s, y = charges)) + geom_bar()
hccd %>% group_by(region) %>% summarise(mean(charges))
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_bar()
hccd %>% group_by(region) %>% summarise(z = mean(charges))
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_bar()
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col()
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + labs(title = "Distribution of Charge(mean) with respect to the region", x = Region, y = Charge($))
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + labs(title = "Distribution of Charge(mean) with respect to the region", x = "Region"", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + labs(title = "Distribution of Charge(mean) with respect to the region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + labs(title = "Charge according to the Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + labs(title = "Average Charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + theme_classic() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + theme_classic() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + theme_minimal() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = region)) + geom_col() + theme_minimal() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = region)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = children)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = smoker)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = sex)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = region)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z)) + geom_col() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z)) + geom_col() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z)) + geom_col() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col() + labs(title = "Average charge by Sex", x = "Sex", y = "Charge($)")
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col() + labs(title = "Average charge by Sex", x = "Sex", y = "Charge($)")
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col() + labs(title = "Average charge by Sex", x = "Sex", y = "Charge($)")
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col() + labs(title = "Average charge by Sex", x = "Sex", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges, color = sex)) + geom_point() + labs(title = "Scatter plot of Age and Charge with Smoking Status", x = "Age", y = "Charge($)")
hccd %>% group_by(children) %>% ggplot(aes(x = children, y = charges, fill = children)) + geom_bar() + labs(title = "Average Charge by the number of children")
hccd %>% group_by(children) %>% ggplot(aes(x = children, y = charges, fill = children)) + geom_col() + labs(title = "Average Charge by the number of children")
hccd %>% group_by(children) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = children, y = z, fill = children)) + geom_col() + labs(title = "Average Charge by the number of children")
hccd %>% group_by(children) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = children, y = z, fill = children)) + geom_col() + labs(title = "Average Charge by the number of children", x = "Number of Children", y = "Mean Charge($)")
hccd %>% group_by(age, bmi) %>% summarise(count = n())
hccd %>% group_by(age, smoker) %>% summarise(count = n())
hccd %>% cut(age, breaks = c(17, 27, 37, 47, 57, 67, 77), labels = c("18 - 27", "28 - 37", "38 - 47", "48 - 57", "58 - 67", "68 - 77"))
hccd %>% cut(as.numeric(age), breaks = c(17, 27, 37, 47, 57, 67, 77), labels = c("18 - 27", "28 - 37", "38 - 47", "48 - 57", "58 - 67", "68 - 77"))
hccd %>% cut(as.numeric(hccd$age), breaks = c(17, 27, 37, 47, 57, 67, 77), labels = c("18 - 27", "28 - 37", "38 - 47", "48 - 57", "58 - 67", "68 - 77"))
hccd %>% cut(hccd$age, breaks = c(17, 27, 37, 47, 57, 67, 77), labels = c("18 - 27", "28 - 37", "38 - 47", "48 - 57", "58 - 67", "68 - 77")
)
hccd %>% cor(age, bmi, children, charges)
cor(hccd$age, hccd$bmi, hccd$children, hccd$charges)
hccd %>% select(age, bmi, children, charges) %>% cor()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt()
library("reshape2")
library(reshape2)
library(tidyr)
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt()
library(reshape2)
install.packages("tidyr")
install.packages("tidyr")
getwd()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt()
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(visdat)
hccd <- read.csv("insurance.csv")
colnames(hccd)
head(hccd)
str(hccd)
summary(hccd)
vis_miss(hccd)
hccd <- hccd %>% distinct()
hccd %>% group_by(sex) %>% count()
hccd %>% group_by(smoker) %>% summarise(mean(charges))
hccd %>% group_by(sex) %>% summarise(mean(charges))
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% count() %>% summarise(percent = n*100/675)
hccd %>% filter(sex == 'female') %>% group_by(smoker) %>% count() %>% summarise(percent = n*100/662)
hccd %>% group_by(region) %>% summarise(mean(charges))
hccd %>% group_by(region) %>% count()
hccd %>% group_by(children) %>% summarise(mean(charges))
hccd %>% group_by(children) %>% count()
hccd %>% ggplot(aes(x = bmi, y = charges, color = age)) + geom_point() + labs(title = "Scatter plot of BMI and Charge with Age of the Person", x = "BMI", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges, color = smoker)) + geom_point() + labs(title = "Scatter plot of Age and Charge with Smoking Status", x = "Age", y = "Charge($)")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = region)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)")
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col() + labs(title = "Average charge by Sex", x = "Sex", y = "Charge($)")
hccd %>% ggplot(aes(x = age, y = charges, color = sex)) + geom_point() + labs(title = "Scatter plot of Age and Charge with Smoking Status", x = "Age", y = "Charge($)")
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt()
library(reshape2)
install.packages("reshape2")
library(reshape2)
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile() + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile() + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables")
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile() + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "blue") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "purple") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "purple") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "purple") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "blue") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "lightblue", high = "blue") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "lightblue1", high = "blue") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "blue", high = "blue4") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "blue4") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "purple") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "steelblue") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col(color = "white") + labs(title = "Average charge by Sex", x = "Sex", y = "Charge($)")
hccd %>% geom_histogram()
hccd %>% ggplot(aes(x = charges)) %>% geom_histogram()
hccd %>% ggplot(aes(x = charges, y = sum())) %>% geom_histogram()
hccd %>% ggplot(aes(x = charges, y = n) %>% geom_histogram()
hist(hccd$charges)
hccd %>% ggplot(aes(x = charges) %>% geom_histogram()
hccd %>% ggplot(aes(x = charges)) %>% geom_histogram()
hccd %>% ggplot(aes(x = charges)) + geom_histogram()
hccd %>% ggplot(aes(x = charges, fill = charges)) + geom_histogram() +
labs(title = "Saxsux")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(color = "steelblue") +
labs(title = "saxsux")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(fill = "steelblue", color = "steelblue")
hccd %>% ggplot(aes(x = charges)) + geom_histogram() + scale_fill_gradient(low = "steelblue", high = "steelblue4")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(color = "white") + scale_fill_gradient(low = "steelblue", high = "steelblue4")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(fill = after_stat(x) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "steelblue4")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "steelblue4")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "blue4")
install.packages("ggthemes")
library(ggthemes)
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + theme_economist()
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + theme_fivethirtyeight()
hccd %>% ggplot(x = charges) + geom_histogram() + theme_fivethirtyeight()
hccd %>% ggplot(aes(x = charges)) + geom_histogram() + theme_fivethirtyeight()
hccd %>% ggplot(aes(x = charges)) + geom_histogram() + theme_excel()
hccd %>% ggplot(aes(x = charges)) + geom_histogram() + theme_foundation()
hccd %>% ggplot(aes(x = charges)) + geom_histogram() + theme_solarized()
hccd %>% ggplot(aes(x = charges)) + geom_histogram() + theme_wsj()
hccd %>% ggplot(aes(x = charges)) + geom_histogram()
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "blue4")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "steelblue4")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "steelblue4")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "steelblue4")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "steelblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "royalblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi, y = charges, color = age)) + geom_point() + labs(title = "Scatter plot of BMI and Charge with Age of the Person", x = "BMI", y = "Charge($)")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "steelblue", high = "midnightblue") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "lightskyblue", high = "midnightblue") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "lightskyblue", high = "navyblue") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "lightskyblue", high = "royalblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi, y = charges, color = age)) + geom_point() + labs(title = "Scatter plot of BMI and Charge with Age of the Person", x = "BMI", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = region)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age)) + geom_histogram(aes(fill = after_stat(x)), color = "white") + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age)) + geom_histogram(aes(fill = after_stat(x), bins = 10), color = "white") + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = children)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 1) + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = children)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 1) + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = children)) + geom_histogram(aes(fill = after_stat(x)), color = "white") + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "royalblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = children)) + geom_histogram(aes(fill = after_stat(x)), color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(visdat)
hccd <- read.csv("insurance.csv")
colnames(hccd)
head(hccd)
str(hccd)
summary(hccd)
vis_miss(hccd)
hccd <- hccd %>% distinct()
hccd %>% group_by(sex) %>% count()
hccd %>% group_by(smoker) %>% summarise(mean(charges))
hccd %>% group_by(sex) %>% summarise(mean(charges))
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% count() %>% summarise(percent = n*100/675)
hccd %>% filter(sex == 'female') %>% group_by(smoker) %>% count() %>% summarise(percent = n*100/662)
hccd %>% group_by(region) %>% summarise(mean(charges))
hccd %>% group_by(region) %>% count()
hccd %>% group_by(children) %>% summarise(mean(charges))
hccd %>% group_by(children) %>% count()
hccd %>% ggplot(aes(x = bmi, y = charges, color = age)) + geom_point() + labs(title = "Scatter plot of BMI and Charge with Age of the Person", x = "BMI", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = children)) + geom_histogram(aes(fill = after_stat(x)), color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age, y = charges, color = smoker)) + geom_point() + labs(title = "Scatter plot of Age and Charge with Smoking Status", x = "Age", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = region)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col() + labs(title = "Average charge by Sex", x = "Sex", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age, y = charges, color = sex)) + geom_point() + labs(title = "Scatter plot of Age and Charge with Smoking Status", x = "Age", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(children) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = children, y = z, fill = children)) + geom_col() + labs(title = "Average Charge by the number of children", x = "Number of Children", y = "Mean Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "steelblue") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(visdat)
hccd <- read.csv("insurance.csv")
colnames(hccd)
head(hccd)
str(hccd)
summary(hccd)
vis_miss(hccd)
hccd <- hccd %>% distinct()
hccd %>% group_by(sex) %>% count()
hccd %>% group_by(smoker) %>% summarise(mean(charges))
hccd %>% group_by(sex) %>% summarise(mean(charges))
hccd %>% filter(sex == 'male') %>% group_by(smoker) %>% count() %>% summarise(percent = n*100/675)
hccd %>% filter(sex == 'female') %>% group_by(smoker) %>% count() %>% summarise(percent = n*100/662)
hccd %>% group_by(region) %>% summarise(mean(charges))
hccd %>% group_by(region) %>% count()
hccd %>% group_by(children) %>% summarise(mean(charges))
hccd %>% group_by(children) %>% count()
hccd %>% ggplot(aes(x = bmi, y = charges, color = age)) + geom_point() + labs(title = "Scatter plot of BMI and Charge with Age of the Person", x = "BMI", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = children)) + geom_histogram(aes(fill = after_stat(x)), color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age, y = charges, color = smoker)) + geom_point() + labs(title = "Scatter plot of Age and Charge with Smoking Status", x = "Age", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = region)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col() + labs(title = "Average charge by Sex", x = "Sex", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age, y = charges, color = sex)) + geom_point() + labs(title = "Scatter plot of Age and Charge with Smoking Status", x = "Age", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(children) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = children, y = z, fill = children)) + geom_col() + labs(title = "Average Charge by the number of children", x = "Number of Children", y = "Mean Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = charges)) + geom_histogram(aes(fill = after_stat(x)) ,color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribtion of the charge paid by the People", x = "Charge($)", y = " Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi, y = charges, color = age)) + geom_point() + labs(title = "Scatter plot of BMI and Charge with Age of the Person", x = "BMI", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = age)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = bmi)) + geom_histogram(aes(fill = after_stat(x)), color = "white", bins = 10) + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of BMI in the dataset", x = "BMI", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% ggplot(aes(x = children)) + geom_histogram(aes(fill = after_stat(x)), color = "white") + scale_fill_gradient(low = "skyblue", high = "steelblue4") + labs(title = "Distribution of Age in the dataset", x = "Age", y = "Count", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>%  group_by(children) %>% summarise(count())
hccd %>%  group_by(children) %>% summarise(sum()
)
hccd %>%  group_by(children) %>% count()
hccd %>% ggplot(aes(x = age, y = charges, color = smoker)) + geom_point() + labs(title = "Scatter plot of Age and Charge with Smoking Status", x = "Age", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(region) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = region, y = z, fill = region)) + geom_col() + theme_light() + labs(title = "Average charge by Region", x = "Region", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(region) %>% count()
hccd %>% group_by(sex) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = sex, y = z, fill = sex)) + geom_col() + labs(title = "Average charge by Sex", x = "Sex", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(sex) %>% count()
hccd %>% ggplot(aes(x = age, y = charges, color = sex)) + geom_point() + labs(title = "Scatter plot of Age and Charge with Smoking Status", x = "Age", y = "Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(children) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = children, y = z, fill = children)) + geom_col() + labs(title = "Average Charge by the number of children", x = "Number of Children", y = "Mean Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% group_by(cchildren) %>% summarise(mean(charges))
hccd %>% group_by(children) %>% summarise(mean(charges))
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "steelblue") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% group_by(children) %>% summarise(z = mean(charges)) %>% ggplot(aes(x = children, y = z, fill = children)) + geom_col() + labs(title = "Average charge with respect to the number of children", x = "Number of Children", y = "Mean Charge($)", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle")
hccd %>% select(age, bmi, children, charges) %>% cor() %>% melt() %>% ggplot(aes(x = Var1, y = Var2, fill = value)) + geom_tile(color = "white") + scale_fill_gradient(low = "white", high = "steelblue") + labs(title = "Correlation between Age, BMI, Children and Charges", subtitle = "Healthcare Cost Dataset", caption = "Data source: Kaggle", x = "Variables", y = "Variables") + theme_minimal()
hccd %>% group_by(sex) %>% summarise(mean(charges))
hccd %>% as.factor(smoker)
as.factor(hccd$region)
as.factor(hccd$children)
as.factor(hccd$sex)
